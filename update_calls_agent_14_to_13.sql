-- Script para cambiar agent_id de 14 a 13 en la tabla calls
-- Busca registros con phone_to específicos que tengan agent_id = 14

-- Primero, vamos a ver cuántos registros coinciden con esos números y tienen agent_id = 14
SELECT 
    COUNT(*) as total_records_to_update,
    phone_to,
    agent_id,
    COUNT(*) as count_per_number
FROM calls 
WHERE phone_to IN (
    '+34651546678', '+34676174516', '+34616956923', '+34669858479', '+34620323188',
    '+34609811633', '+34661879152', '+34612591759', '+34638752540', '+34626291323',
    '+34649267035', '+34625050122', '+34605939727', '+34680346909', '+34649197920',
    '+34699065967', '+34616755996', '+34606709069', '+34682590028', '+34620343499',
    '+34609815052', '+34659342080', '+34608880639', '+34675141340', '+34610949054',
    '+34660771188', '+34628665108', '+34619460442', '+34616727532', '+34646164597',
    '+34679910768', '+34626441687', '+34650564669', '+34692129121', '+34627560262',
    '+34659496697', '+34645200612', '+34616221316', '+34639759732', '+34619302002',
    '+34642166242', '+34622050237', '+34627214335', '+34673118660', '+34616444583',
    '+34670321797', '+34620604346', '+34603770380', '+34627467987', '+34666915264',
    '+34664121522', '+34639671738', '+34650464637', '+34660697925', '+34605421300',
    '+34617601316', '+34656961518', '+34610876731', '+34699667387', '+34627173760',
    '+34657524030', '+34606999997', '+34626714680', '+34605540300', '+34607554574',
    '+34630835745', '+34628766731', '+34629015859', '+34660805020', '+34617194734',
    '+34616640702', '+34610153576', '+34602451757', '+34678440199', '+34633926875',
    '+34652795327', '+34677084204', '+34680781805', '+34650874265', '+34606621676',
    '+34605369732', '+34616099762', '+34678790538', '+34687548393', '+34654045998',
    '+34661627706', '+34636882165', '+34626280604', '+34618821128', '+34675473266',
    '+34610985261', '+34640765989', '+34677314193', '+34690132770', '+34680773505',
    '+34623151728', '+34650494439', '+34619947153', '+34608247402', '+34661063530',
    '+34670532678', '+34627981650', '+34636075096', '+34605634561', '+34685772708',
    '+34629237022', '+34646922764', '+34655133943', '+34686455804', '+34607442305',
    '+34618042810', '+34651040534', '+34665142682', '+34650582415', '+34678472995',
    '+34678133490', '+34658116642', '+34663912451', '+34607844813', '+34650050990',
    '+34662304541', '+34620654509', '+34656861510', '+34608724813', '+34667863411',
    '+34613976072', '+34652548990', '+34630132787', '+34605336991', '+34698126637',
    '+34677117852', '+34637260184', '+34667795133', '+34656486060', '+34619641867',
    '+34640852179', '+34677158057', '+34672251616', '+34616291553', '+34696805584',
    '+34655430121', '+34669444815', '+34661775960', '+34619000305', '+34675942486',
    '+34656561873', '+34659793098', '+34607744606', '+34656524344', '+34679153499',
    '+34653901680', '+34625579471', '+34657175534', '+34635892694', '+34637362906',
    '+34698133645', '+34664510177', '+34616429570', '+34626135641', '+34678961106',
    '+34624884648', '+34618948204', '+34626901220', '+34642609048', '+34607155561',
    '+34666049442', '+34678642454', '+34634931745', '+34656993044', '+34647601594',
    '+34626878564', '+34686126654', '+34636871647', '+34609878890', '+34686899236',
    '+34617296819', '+34686304618', '+34650932745', '+34625584038', '+34670010190',
    '+34615416833', '+34698173470', '+34604110906', '+34609216984', '+34619056049',
    '+34647854157', '+34649466944', '+34600043955', '+34649256933', '+34674843379',
    '+34655391371', '+34616471444', '+34604979542', '+34663509305', '+34673763940',
    '+34645409888', '+34695115706', '+34696915884', '+34677625245', '+34686347142',
    '+34653582649', '+34672566723', '+34604062136', '+34634824467', '+34671754324',
    '+34629310661', '+34698158890', '+34627388812', '+34680612892', '+34605327320',
    '+34607373671', '+34621092055', '+34625822334', '+34659836477', '+34641415639',
    '+34659752330', '+34692869661', '+34666171442', '+34630944223', '+34669756604',
    '+34687960134', '+34609479394', '+34625131992', '+34605105465', '+34678599242',
    '+34617784341', '+34664840374', '+34655258163', '+34619635256', '+34633797965',
    '+34661296000', '+34686756881', '+34690087933', '+34646098972', '+34619825545',
    '+34649306078', '+34639129041', '+34675533103', '+34608226027', '+34637758590',
    '+34666990860', '+34633125202', '+34676366710', '+34671639375', '+34625575532',
    '+34699409395', '+34625744622', '+34649676371', '+34685717429', '+34697341250',
    '+34630742999', '+34606625067', '+34658921505', '+34625405944', '+34628061999',
    '+34686473360', '+34661656205', '+34678365918', '+34662303902', '+34696563072',
    '+34655514118', '+34605902724', '+34652860653', '+34645918001', '+34651596726',
    '+34610906544', '+34686092192', '+34637316648', '+34640612654', '+34616124476',
    '+34649605444', '+34605796884', '+34687877929', '+34625686402', '+34670772284',
    '+34617509739', '+34600225496', '+34699363996', '+34692271594', '+34620787273',
    '+34653937619', '+34639724242', '+34630939458', '+34661841957', '+34606329018',
    '+34647647620', '+34639916451', '+34655087768', '+34630407052', '+34618020721',
    '+34669489370', '+34605952790', '+34649835918', '+34670579654', '+34605837911',
    '+34669968120', '+34616046095', '+34635552204', '+34620337111', '+34636723792',
    '+34698135939', '+34620222460', '+34691233090', '+34697354523', '+34645999441',
    '+34661822615', '+34609817964', '+34677306561', '+34654064743', '+34617233310',
    '+34636596561', '+34625607290', '+34679429141', '+34610890465', '+34661390094',
    '+34634950934', '+34626312089', '+34678699532', '+34697590826', '+34698154269',
    '+34669356480', '+34656668395', '+34622532091', '+34630139919', '+34618076434',
    '+34649541691', '+34645660321', '+34658319289', '+34617981680', '+34656850517',
    '+34676553871', '+34686113083', '+34669165444', '+34677435166', '+34699706871',
    '+34606935818', '+34696624414', '+34722566391', '+34658582585', '+34625926010',
    '+34653351692', '+34698487648', '+34647552864', '+34619500525', '+34683515751',
    '+34722544384', '+34647179829', '+34637970710', '+34689267588', '+34627765423',
    '+34680211465', '+34667658984', '+34682266043', '+34722305789', '+34693930783',
    '+34607429037', '+34674534377', '+34635156679', '+34655551225', '+34638479039',
    '+34635035050', '+34658404202', '+34639377225', '+34653086959', '+34649509663',
    '+34699091591', '+34672233668', '+34654346235', '+34649182720', '+34630857057',
    '+34627809353', '+34674473956', '+34619452501', '+34622501523', '+34650695320',
    '+34675661004', '+34613346278', '+34618820004', '+34606555638', '+34602082547',
    '+34630606261', '+34692319966', '+34670354425', '+34634122519', '+34722198786',
    '+34630706404', '+34615820353', '+34653437173', '+34614182052', '+34628829347',
    '+34677408494', '+34609336027', '+34650299089', '+34649080184', '+34606882661',
    '+34609854386', '+34602470547', '+34626521328', '+34679071823', '+34656817437',
    '+34600922094', '+34686132734', '+34618858237', '+34658030869', '+34657094943',
    '+34693432563', '+34615606000', '+34615461694', '+34607553299', '+34638680004',
    '+34661117632', '+34650484605', '+34629863427', '+34607323108', '+34691167091',
    '+34616857413', '+34685249969', '+34680809435', '+34611458038', '+34686037382',
    '+34661285963', '+34697520598', '+34673483340', '+34616603929', '+34659023519',
    '+34622039919', '+34620716756', '+34626645554', '+34664618305', '+34653289233',
    '+34600263767', '+34660375843', '+34670069703', '+34675900984', '+34685504923',
    '+34685705215', '+34608550795'
)
AND agent_id = 14
GROUP BY phone_to, agent_id;

-- Actualizar todos los registros que coincidan con esos números
-- y tengan agent_id = 14, cambiándolos a agent_id = 13
UPDATE calls 
SET 
    agent_id = 13,
    updated_at = NOW()
WHERE phone_to IN (
    '+34651546678', '+34676174516', '+34616956923', '+34669858479', '+34620323188',
    '+34609811633', '+34661879152', '+34612591759', '+34638752540', '+34626291323',
    '+34649267035', '+34625050122', '+34605939727', '+34680346909', '+34649197920',
    '+34699065967', '+34616755996', '+34606709069', '+34682590028', '+34620343499',
    '+34609815052', '+34659342080', '+34608880639', '+34675141340', '+34610949054',
    '+34660771188', '+34628665108', '+34619460442', '+34616727532', '+34646164597',
    '+34679910768', '+34626441687', '+34650564669', '+34692129121', '+34627560262',
    '+34659496697', '+34645200612', '+34616221316', '+34639759732', '+34619302002',
    '+34642166242', '+34622050237', '+34627214335', '+34673118660', '+34616444583',
    '+34670321797', '+34620604346', '+34603770380', '+34627467987', '+34666915264',
    '+34664121522', '+34639671738', '+34650464637', '+34660697925', '+34605421300',
    '+34617601316', '+34656961518', '+34610876731', '+34699667387', '+34627173760',
    '+34657524030', '+34606999997', '+34626714680', '+34605540300', '+34607554574',
    '+34630835745', '+34628766731', '+34629015859', '+34660805020', '+34617194734',
    '+34616640702', '+34610153576', '+34602451757', '+34678440199', '+34633926875',
    '+34652795327', '+34677084204', '+34680781805', '+34650874265', '+34606621676',
    '+34605369732', '+34616099762', '+34678790538', '+34687548393', '+34654045998',
    '+34661627706', '+34636882165', '+34626280604', '+34618821128', '+34675473266',
    '+34610985261', '+34640765989', '+34677314193', '+34690132770', '+34680773505',
    '+34623151728', '+34650494439', '+34619947153', '+34608247402', '+34661063530',
    '+34670532678', '+34627981650', '+34636075096', '+34605634561', '+34685772708',
    '+34629237022', '+34646922764', '+34655133943', '+34686455804', '+34607442305',
    '+34618042810', '+34651040534', '+34665142682', '+34650582415', '+34678472995',
    '+34678133490', '+34658116642', '+34663912451', '+34607844813', '+34650050990',
    '+34662304541', '+34620654509', '+34656861510', '+34608724813', '+34667863411',
    '+34613976072', '+34652548990', '+34630132787', '+34605336991', '+34698126637',
    '+34677117852', '+34637260184', '+34667795133', '+34656486060', '+34619641867',
    '+34640852179', '+34677158057', '+34672251616', '+34616291553', '+34696805584',
    '+34655430121', '+34669444815', '+34661775960', '+34619000305', '+34675942486',
    '+34656561873', '+34659793098', '+34607744606', '+34656524344', '+34679153499',
    '+34653901680', '+34625579471', '+34657175534', '+34635892694', '+34637362906',
    '+34698133645', '+34664510177', '+34616429570', '+34626135641', '+34678961106',
    '+34624884648', '+34618948204', '+34626901220', '+34642609048', '+34607155561',
    '+34666049442', '+34678642454', '+34634931745', '+34656993044', '+34647601594',
    '+34626878564', '+34686126654', '+34636871647', '+34609878890', '+34686899236',
    '+34617296819', '+34686304618', '+34650932745', '+34625584038', '+34670010190',
    '+34615416833', '+34698173470', '+34604110906', '+34609216984', '+34619056049',
    '+34647854157', '+34649466944', '+34600043955', '+34649256933', '+34674843379',
    '+34655391371', '+34616471444', '+34604979542', '+34663509305', '+34673763940',
    '+34645409888', '+34695115706', '+34696915884', '+34677625245', '+34686347142',
    '+34653582649', '+34672566723', '+34604062136', '+34634824467', '+34671754324',
    '+34629310661', '+34698158890', '+34627388812', '+34680612892', '+34605327320',
    '+34607373671', '+34621092055', '+34625822334', '+34659836477', '+34641415639',
    '+34659752330', '+34692869661', '+34666171442', '+34630944223', '+34669756604',
    '+34687960134', '+34609479394', '+34625131992', '+34605105465', '+34678599242',
    '+34617784341', '+34664840374', '+34655258163', '+34619635256', '+34633797965',
    '+34661296000', '+34686756881', '+34690087933', '+34646098972', '+34619825545',
    '+34649306078', '+34639129041', '+34675533103', '+34608226027', '+34637758590',
    '+34666990860', '+34633125202', '+34676366710', '+34671639375', '+34625575532',
    '+34699409395', '+34625744622', '+34649676371', '+34685717429', '+34697341250',
    '+34630742999', '+34606625067', '+34658921505', '+34625405944', '+34628061999',
    '+34686473360', '+34661656205', '+34678365918', '+34662303902', '+34696563072',
    '+34655514118', '+34605902724', '+34652860653', '+34645918001', '+34651596726',
    '+34610906544', '+34686092192', '+34637316648', '+34640612654', '+34616124476',
    '+34649605444', '+34605796884', '+34687877929', '+34625686402', '+34670772284',
    '+34617509739', '+34600225496', '+34699363996', '+34692271594', '+34620787273',
    '+34653937619', '+34639724242', '+34630939458', '+34661841957', '+34606329018',
    '+34647647620', '+34639916451', '+34655087768', '+34630407052', '+34618020721',
    '+34669489370', '+34605952790', '+34649835918', '+34670579654', '+34605837911',
    '+34669968120', '+34616046095', '+34635552204', '+34620337111', '+34636723792',
    '+34698135939', '+34620222460', '+34691233090', '+34697354523', '+34645999441',
    '+34661822615', '+34609817964', '+34677306561', '+34654064743', '+34617233310',
    '+34636596561', '+34625607290', '+34679429141', '+34610890465', '+34661390094',
    '+34634950934', '+34626312089', '+34678699532', '+34697590826', '+34698154269',
    '+34669356480', '+34656668395', '+34622532091', '+34630139919', '+34618076434',
    '+34649541691', '+34645660321', '+34658319289', '+34617981680', '+34656850517',
    '+34676553871', '+34686113083', '+34669165444', '+34677435166', '+34699706871',
    '+34606935818', '+34696624414', '+34722566391', '+34658582585', '+34625926010',
    '+34653351692', '+34698487648', '+34647552864', '+34619500525', '+34683515751',
    '+34722544384', '+34647179829', '+34637970710', '+34689267588', '+34627765423',
    '+34680211465', '+34667658984', '+34682266043', '+34722305789', '+34693930783',
    '+34607429037', '+34674534377', '+34635156679', '+34655551225', '+34638479039',
    '+34635035050', '+34658404202', '+34639377225', '+34653086959', '+34649509663',
    '+34699091591', '+34672233668', '+34654346235', '+34649182720', '+34630857057',
    '+34627809353', '+34674473956', '+34619452501', '+34622501523', '+34650695320',
    '+34675661004', '+34613346278', '+34618820004', '+34606555638', '+34602082547',
    '+34630606261', '+34692319966', '+34670354425', '+34634122519', '+34722198786',
    '+34630706404', '+34615820353', '+34653437173', '+34614182052', '+34628829347',
    '+34677408494', '+34609336027', '+34650299089', '+34649080184', '+34606882661',
    '+34609854386', '+34602470547', '+34626521328', '+34679071823', '+34656817437',
    '+34600922094', '+34686132734', '+34618858237', '+34658030869', '+34657094943',
    '+34693432563', '+34615606000', '+34615461694', '+34607553299', '+34638680004',
    '+34661117632', '+34650484605', '+34629863427', '+34607323108', '+34691167091',
    '+34616857413', '+34685249969', '+34680809435', '+34611458038', '+34686037382',
    '+34661285963', '+34697520598', '+34673483340', '+34616603929', '+34659023519',
    '+34622039919', '+34620716756', '+34626645554', '+34664618305', '+34653289233',
    '+34600263767', '+34660375843', '+34670069703', '+34675900984', '+34685504923',
    '+34685705215', '+34608550795'
)
AND agent_id = 14;

-- Verificar que la actualización se realizó correctamente
SELECT 
    COUNT(*) as total_updated_records,
    phone_to,
    agent_id,
    COUNT(*) as count_per_number
FROM calls 
WHERE phone_to IN (
    '+34651546678', '+34676174516', '+34616956923', '+34669858479', '+34620323188',
    '+34609811633', '+34661879152', '+34612591759', '+34638752540', '+34626291323',
    '+34649267035', '+34625050122', '+34605939727', '+34680346909', '+34649197920',
    '+34699065967', '+34616755996', '+34606709069', '+34682590028', '+34620343499',
    '+34609815052', '+34659342080', '+34608880639', '+34675141340', '+34610949054',
    '+34660771188', '+34628665108', '+34619460442', '+34616727532', '+34646164597',
    '+34679910768', '+34626441687', '+34650564669', '+34692129121', '+34627560262',
    '+34659496697', '+34645200612', '+34616221316', '+34639759732', '+34619302002',
    '+34642166242', '+34622050237', '+34627214335', '+34673118660', '+34616444583',
    '+34670321797', '+34620604346', '+34603770380', '+34627467987', '+34666915264',
    '+34664121522', '+34639671738', '+34650464637', '+34660697925', '+34605421300',
    '+34617601316', '+34656961518', '+34610876731', '+34699667387', '+34627173760',
    '+34657524030', '+34606999997', '+34626714680', '+34605540300', '+34607554574',
    '+34630835745', '+34628766731', '+34629015859', '+34660805020', '+34617194734',
    '+34616640702', '+34610153576', '+34602451757', '+34678440199', '+34633926875',
    '+34652795327', '+34677084204', '+34680781805', '+34650874265', '+34606621676',
    '+34605369732', '+34616099762', '+34678790538', '+34687548393', '+34654045998',
    '+34661627706', '+34636882165', '+34626280604', '+34618821128', '+34675473266',
    '+34610985261', '+34640765989', '+34677314193', '+34690132770', '+34680773505',
    '+34623151728', '+34650494439', '+34619947153', '+34608247402', '+34661063530',
    '+34670532678', '+34627981650', '+34636075096', '+34605634561', '+34685772708',
    '+34629237022', '+34646922764', '+34655133943', '+34686455804', '+34607442305',
    '+34618042810', '+34651040534', '+34665142682', '+34650582415', '+34678472995',
    '+34678133490', '+34658116642', '+34663912451', '+34607844813', '+34650050990',
    '+34662304541', '+34620654509', '+34656861510', '+34608724813', '+34667863411',
    '+34613976072', '+34652548990', '+34630132787', '+34605336991', '+34698126637',
    '+34677117852', '+34637260184', '+34667795133', '+34656486060', '+34619641867',
    '+34640852179', '+34677158057', '+34672251616', '+34616291553', '+34696805584',
    '+34655430121', '+34669444815', '+34661775960', '+34619000305', '+34675942486',
    '+34656561873', '+34659793098', '+34607744606', '+34656524344', '+34679153499',
    '+34653901680', '+34625579471', '+34657175534', '+34635892694', '+34637362906',
    '+34698133645', '+34664510177', '+34616429570', '+34626135641', '+34678961106',
    '+34624884648', '+34618948204', '+34626901220', '+34642609048', '+34607155561',
    '+34666049442', '+34678642454', '+34634931745', '+34656993044', '+34647601594',
    '+34626878564', '+34686126654', '+34636871647', '+34609878890', '+34686899236',
    '+34617296819', '+34686304618', '+34650932745', '+34625584038', '+34670010190',
    '+34615416833', '+34698173470', '+34604110906', '+34609216984', '+34619056049',
    '+34647854157', '+34649466944', '+34600043955', '+34649256933', '+34674843379',
    '+34655391371', '+34616471444', '+34604979542', '+34663509305', '+34673763940',
    '+34645409888', '+34695115706', '+34696915884', '+34677625245', '+34686347142',
    '+34653582649', '+34672566723', '+34604062136', '+34634824467', '+34671754324',
    '+34629310661', '+34698158890', '+34627388812', '+34680612892', '+34605327320',
    '+34607373671', '+34621092055', '+34625822334', '+34659836477', '+34641415639',
    '+34659752330', '+34692869661', '+34666171442', '+34630944223', '+34669756604',
    '+34687960134', '+34609479394', '+34625131992', '+34605105465', '+34678599242',
    '+34617784341', '+34664840374', '+34655258163', '+34619635256', '+34633797965',
    '+34661296000', '+34686756881', '+34690087933', '+34646098972', '+34619825545',
    '+34649306078', '+34639129041', '+34675533103', '+34608226027', '+34637758590',
    '+34666990860', '+34633125202', '+34676366710', '+34671639375', '+34625575532',
    '+34699409395', '+34625744622', '+34649676371', '+34685717429', '+34697341250',
    '+34630742999', '+34606625067', '+34658921505', '+34625405944', '+34628061999',
    '+34686473360', '+34661656205', '+34678365918', '+34662303902', '+34696563072',
    '+34655514118', '+34605902724', '+34652860653', '+34645918001', '+34651596726',
    '+34610906544', '+34686092192', '+34637316648', '+34640612654', '+34616124476',
    '+34649605444', '+34605796884', '+34687877929', '+34625686402', '+34670772284',
    '+34617509739', '+34600225496', '+34699363996', '+34692271594', '+34620787273',
    '+34653937619', '+34639724242', '+34630939458', '+34661841957', '+34606329018',
    '+34647647620', '+34639916451', '+34655087768', '+34630407052', '+34618020721',
    '+34669489370', '+34605952790', '+34649835918', '+34670579654', '+34605837911',
    '+34669968120', '+34616046095', '+34635552204', '+34620337111', '+34636723792',
    '+34698135939', '+34620222460', '+34691233090', '+34697354523', '+34645999441',
    '+34661822615', '+34609817964', '+34677306561', '+34654064743', '+34617233310',
    '+34636596561', '+34625607290', '+34679429141', '+34610890465', '+34661390094',
    '+34634950934', '+34626312089', '+34678699532', '+34697590826', '+34698154269',
    '+34669356480', '+34656668395', '+34622532091', '+34630139919', '+34618076434',
    '+34649541691', '+34645660321', '+34658319289', '+34617981680', '+34656850517',
    '+34676553871', '+34686113083', '+34669165444', '+34677435166', '+34699706871',
    '+34606935818', '+34696624414', '+34722566391', '+34658582585', '+34625926010',
    '+34653351692', '+34698487648', '+34647552864', '+34619500525', '+34683515751',
    '+34722544384', '+34647179829', '+34637970710', '+34689267588', '+34627765423',
    '+34680211465', '+34667658984', '+34682266043', '+34722305789', '+34693930783',
    '+34607429037', '+34674534377', '+34635156679', '+34655551225', '+34638479039',
    '+34635035050', '+34658404202', '+34639377225', '+34653086959', '+34649509663',
    '+34699091591', '+34672233668', '+34654346235', '+34649182720', '+34630857057',
    '+34627809353', '+34674473956', '+34619452501', '+34622501523', '+34650695320',
    '+34675661004', '+34613346278', '+34618820004', '+34606555638', '+34602082547',
    '+34630606261', '+34692319966', '+34670354425', '+34634122519', '+34722198786',
    '+34630706404', '+34615820353', '+34653437173', '+34614182052', '+34628829347',
    '+34677408494', '+34609336027', '+34650299089', '+34649080184', '+34606882661',
    '+34609854386', '+34602470547', '+34626521328', '+34679071823', '+34656817437',
    '+34600922094', '+34686132734', '+34618858237', '+34658030869', '+34657094943',
    '+34693432563', '+34615606000', '+34615461694', '+34607553299', '+34638680004',
    '+34661117632', '+34650484605', '+34629863427', '+34607323108', '+34691167091',
    '+34616857413', '+34685249969', '+34680809435', '+34611458038', '+34686037382',
    '+34661285963', '+34697520598', '+34673483340', '+34616603929', '+34659023519',
    '+34622039919', '+34620716756', '+34626645554', '+34664618305', '+34653289233',
    '+34600263767', '+34660375843', '+34670069703', '+34675900984', '+34685504923',
    '+34685705215', '+34608550795'
)
GROUP BY phone_to, agent_id;
